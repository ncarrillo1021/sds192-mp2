---
title: "Mini-Project 2"
author: "Dianne Caravela, Neyda Carrillo"
date: "2019-03-24"
output: 
  html_document:
    code_folding: hide
---

```{r, include = FALSE}
library(tidyverse)
library(devtools)
library(usmap)
library(gridExtra)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

###Committee Party Affiliation 

Creates list of republican committees in a state
```{r, message=FALSE}
party_cmte_REP <- committees %>%
  filter(cmte_state == "AZ") %>%
  filter(cmte_party_affiliation == "REP") %>%
  group_by(cmte_party_affiliation) %>%
  select(cmte_id) 
```

Creates list of Democratic committees in a state
```{r, message=FALSE}
party_cmte_DEM <- committees %>%
  filter(cmte_state == "AZ") %>%
  filter(cmte_party_affiliation == "DEM") %>%
  group_by(cmte_party_affiliation) %>%
  select(cmte_id)
```

###Committee Contribution  

Creates table with just committee ID and transaction info for every transaction
```{r, message=FALSE}
trans_amt <- contributions %>%
  select(cmte_id, transaction_amt)
```

###Committe Expenditure

Joins Rebublican committee list with transactions, summarizes the number of committies and the total amount of money they recieved
```{r, message=FALSE}
cmte_expenditure_REP <- inner_join(party_cmte_REP, trans_amt)  %>%
  summarize(num_committees = n(), total_cont = sum(transaction_amt))
```

Does the same with Democratic committees
```{r, message=FALSE}
cmte_expenditure_DEM <- inner_join(party_cmte_DEM, trans_amt)  %>%
  summarize(num_committees = n(), total_cont = sum(transaction_amt))
```

Joins Republican and Democratic summary tables
```{r, message=FALSE}
final_table <- full_join(cmte_expenditure_DEM, cmte_expenditure_REP)
final_table
```


Creates graphs of number of committees by party and of total contributions by party
```{r}
total_cont_graph <- ggplot(final_table, aes(x = cmte_party_affiliation, y = total_cont, fill = cmte_party_affiliation)) +
  geom_bar( stat = "identity", width = 0.5) +
  scale_fill_manual(breaks = c("DEM", "REP"),
                    values = c("blue", "red")) +
  guides(fill = FALSE)


num_commit_graph <- ggplot(final_table, aes(x = cmte_party_affiliation, y = num_committees, fill = cmte_party_affiliation)) +
  geom_bar( stat = "identity", width = 0.5) +
  scale_fill_manual(breaks = c("DEM", "REP"),
                    values = c("blue", "red")) +
  guides(fill = FALSE)


grid.arrange(num_commit_graph, total_cont_graph, nrow = 1)
```

ratio_table <- final_table %>%
  spread(key = cmte_party_affiliation, value = num_committees) %>%
  mutate(percent_rep_commit = )
ratio_table
mutate()

> Word count: 'r wordcountaddin::word_count()'



